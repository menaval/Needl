
<h1>Profil</h1>
<div class="container">
  <div class="row">
    <div class="col-xs-12">
      <div class="card-white">
        <div class = "text-center" id ="profil">
          <div><%= image_tag(@user.picture, class: "img-circle padded", id: "img-profil") %></div>
          <h2><%= @user.name %></h2>
          <p><%= @user.email %></p>
        </div>

        <!-- modifier si c'est ma page -->
        <% if @user == current_user %>
          <div class="text-center" id="action-btn">
            <ul class="list-inline">
              <li>
                <%= link_to("Modifier", edit_user_registration_path, class: "btn btn-success btn-xs btn-right") %></li>
              </li>
              <li>
                <%= link_to destroy_user_session_path, class: "btn btn-success btn-xs", method: :delete do %>
                <i class="fa fa-sign-out"></i>  <%= t ".sign_out", default: "Se Déconnecter" %>
                <% end %>
              </li>
            </ul>
          </div>
        <% end %>
        <!-- fin -->
      </div>
    </div>
  </div>
  <h2 class = 'text-center'>Recommandations</h2>
  <div class="carousel">
    <% @user.my_restaurants.each do |restaurant| %>
        <%= link_to restaurant_path(restaurant.id) do %>
          <div class="card-white">
            <div id="image_field" style="background: url(<%= image_path(restaurant.restaurant_pictures.first ? restaurant.restaurant_pictures.first.picture : restaurant.picture_url) %>); background-repeat:no-repeat; background-size:cover; background-position:50% 50%">
              <div id="text-left">
                <h2><%= restaurant.name %></h2>
                <h3><%= restaurant.food.name %></h3>
              </div>
              <div id="text-right", class="icon-box">
                <%= render "restaurants/price_ranges/level_#{restaurant.price_range}.svg" %>
              </div>
            </div>
          <p class="quote"><%= Recommendation.where(restaurant_id: restaurant.id, user_id: @user.id).first.review %></p>
        </div>
      <% end %>
    <% end %>
  </div>
  <% if @user != current_user %>
  <% friendship = Friendship.find_by(sender_id: [current_user.id, @user.id], receiver_id: [current_user.id, @user.id]) %>
      <div class="card-white">
        <div class="visibility">
          <% if ( friendship.sender_id == current_user.id && friendship.receiver_invisible == true ) || ( friendship.receiver_id == current_user.id && friendship.sender_invisible == true ) %>
            <%= form_tag visible_friendships_path, id: 'unhide_friend', method: "post" do %>
              <%= hidden_field_tag :id, value: friendship.id %>
              <%= submit_tag "Voir à Nouveau", class: "btn-xs btn-success" %>
            <% end %>
          <% else %>
            <%= form_tag invisible_friendships_path, id: 'hide_friend', method: "post" do %>
              <%= hidden_field_tag :id, value: friendship.id %>
              <%= submit_tag "Ne plus voir", class: "btn-xs btn-danger" %>
            <% end %>
          <% end %>
        </div>
        <div class="delete">
          <%= link_to "Retirer", friendship_path(friendship.id), method: :delete, class: "btn-xs btn-danger" %>
        </div>
      </div>
    </div>
  <% end %>
</div>

